???Windows??Linux????tcpdump????????,?????????tcpdump??:
???| ???? | ????? | ???? | ????? | ???? | ????? |......
1. ???:?????????24???????????????tcpdump????"A1 B2 C3 D4"??"D4 C3 B2 A1"?
2. ???? | ?????:?????,??"???? | ?????"????????????
3. ??????16???,?????????????,???????????????????????????8-11?12-15??(?????,??????0??)??????????????8-11????????,12-15????????,????????,??????????tcpdump?????? -s 0 ??,?8-11???12-15???????
???????,???????????,???????????????????,??????????
4. ?????
????????????????:???????,??RFC894?????,??????RFC 1042?802.3??;???Modem????,??RFC 1055?SLIP??;???ADSL,??RFC 1548?PPP???RFC894/RFC 1042/RFC 1548??????????:
?? | IP??? |(??)
??RFC894,?????14??; ------>???????;
??RFC1042,?????22??;
??RFC1548,?????5??;------>ADSL????;
????????,??IP?????
5.IP???: IP??????: IP?? | IP???
1)IP?????:IP??????IP???0?????,??????IPv4??,?IP????0?????"45"(???'4'??IPv4??;????'5',?IP?????? 5*4=20??,?????????????)?
2)IP???:??IP???20???,??IP???????
IP????????,?IP????2-3?????(???????0??)?
IP?????,???UDP??;
6.UDP???: UDP??| UDP???
1)UDP??:???8?????4-5???UDP????(?8????);
2)UDP???:?????????????,??????????????????????????,????????UDP???????????,????????,????????,??????????????????IP????????????UDP??????????,????????????(??or??);

ÿ
pcap_dump()???.cap????,??????tcpdump?????:
????4???????:D4 C3 B2 A1,????????0xA1B2C3D4?????(????????)??????
????4??????????,?????????????????,?????????4.1Beta4?,?4????:02 00 04 00???,Wireshark??????????????????,?????4????01 00 04 00,?????????main version 1 unsupported???
????8???00,???????
????4????Winpcap???????????,???pcap_open()????????snaplen?????snaplen=65535?,?4????FF FF 00 00.
??4????????,????1?????,6??????,15?????????????????????,?4????01 00 00 00.
?????????????,??????????????????????????16??????,?8??????;??4???????????,????????????60??,???pcap_open()????????snaplen?????50,?????????50,??snaplen???65535,????????????????60;?????????????,?4????;????????,???????????????????????????,?????????????????????????????struct pcap_pkthdr *header?const u_char *pkt_data???????

